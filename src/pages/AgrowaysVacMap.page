<apex:page controller="AgrowaysVacsMapController">
    <apex:pageBlock mode="maindetail">
        <apex:pageBlockSection columns="1" title="Coverage Area">
            <script src="https://maps.google.com/maps/api/js?sensor=false"></script>
            <div id="map" style="width: 400px; height: 400px; margin-left:100px;"></div>
            <script type="text/javascript">
                var locations = {!GpsLocations};       
                var iconURLPrefix = 'https://maps.google.com/mapfiles/ms/icons/';
                var icon = iconURLPrefix + 'red-dot.png';

                var shadow = {
                  anchor: new google.maps.Point(15,33),
                  url: iconURLPrefix + 'msmarker.shadow.png'
                };
            
                var map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 8,
                  center: new google.maps.LatLng(0.4425, 33.4847222222222),
                  mapTypeId: google.maps.MapTypeId.ROADMAP,
                  mapTypeControl: true,
                  streetViewControl: false,
                  panControl: false,
                  zoomControlOptions: {
                     position: google.maps.ControlPosition.RIGHT_BOTTOM
                  }
                });

                var infowindow = new google.maps.InfoWindow({
                  maxWidth: 160
                });

                var marker;
                var markers = new Array();

                // Add the markers and infowindows to the map
                for (var i = 0; i < locations.length; i++) {      
                  marker = new google.maps.Marker({
                    position: new google.maps.LatLng(locations[i][0], locations[i][1]),
                    map: map,
                    icon: icon,
                    shadow: shadow
                  });

                  markers.push(marker);
                  google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                      infowindow.setContent(locations[i][0]);
                      infowindow.open(map, marker);
                    }
                  })(marker, i));
                }
                function AutoCenter() {
                  //  Create a new viewpoint bound
                  var bounds = new google.maps.LatLngBounds();
                  //  Go through each...
                  $.each(markers, function (index, marker) {
                    bounds.extend(marker.position);
                  });
                  //  Fit these bounds to the map
                  map.fitBounds(bounds);
                }
                AutoCenter();                                                       
            </script>
        </apex:pageBlockSection>
    </apex:pageBlock>
</apex:page>