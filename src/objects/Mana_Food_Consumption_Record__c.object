<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <deploymentStatus>Deployed</deploymentStatus>
    <enableHistory>true</enableHistory>
    <enableReports>true</enableReports>
    <fields>
        <fullName>Category__c</fullName>
        <formula>TEXT(Food__r.Category__c)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Category</label>
        <type>Text</type>
    </fields>
    <fields>
        <fullName>Code__c</fullName>
        <formula>IF(OR(ISBLANK(Quantity_Code__c),ISNULL(Quantity_Code__c)),&quot;&quot;,TEXT(Quantity_Code__r.Code__c))</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Code</label>
        <type>Text</type>
    </fields>
    <fields>
        <fullName>Collection_Date__c</fullName>
        <label>Collection Date</label>
        <type>DateTime</type>
    </fields>
    <fields>
        <fullName>Consumption_variation__c</fullName>
        <formula>XP_Total_quantity_consumed__c - LB_Total_quantity_consumed__c</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Consumption variation</label>
        <precision>18</precision>
        <scale>2</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>Food__c</fullName>
        <label>Food</label>
        <referenceTo>Mana_Food__c</referenceTo>
        <relationshipLabel>Food Consumption Records</relationshipLabel>
        <relationshipName>Food_Consumption_Records</relationshipName>
        <relationshipOrder>1</relationshipOrder>
        <type>MasterDetail</type>
    </fields>
    <fields>
        <fullName>Household__c</fullName>
        <label>Household</label>
        <referenceTo>Mana_Household__c</referenceTo>
        <relationshipLabel>Food Consumption Records</relationshipLabel>
        <relationshipName>Food_Consumption_Records</relationshipName>
        <relationshipOrder>0</relationshipOrder>
        <type>MasterDetail</type>
    </fields>
    <fields>
        <fullName>LB_Total_quantity_consumed__c</fullName>
        <formula>IF( LB__c =1, Total_Quantity_Consumed__c ,0)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>LB_Total quantity consumed</label>
        <precision>18</precision>
        <scale>2</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>LB__c</fullName>
        <description>Este campo se llenará con un workflow rule, si es Línea Base se asignará el valor &apos;1&apos;, en caso contrario &apos;0&apos;</description>
        <label>LB</label>
        <precision>18</precision>
        <scale>0</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>Number_Consumed__c</fullName>
        <label>Number Consumed</label>
        <precision>18</precision>
        <required>true</required>
        <scale>2</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>Quantity_Code__c</fullName>
        <label>Quantity Code</label>
        <referenceTo>Mana_Food_Quantity_Code__c</referenceTo>
        <relationshipLabel>Food Consumption Records</relationshipLabel>
        <relationshipName>Food_Consumption_Records</relationshipName>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>Source__c</fullName>
        <label>Source</label>
        <picklist>
            <picklistValues>
                <fullName>Barter</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Other (gift-donation)</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Production</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Purchase</fullName>
                <default>false</default>
            </picklistValues>
            <sorted>false</sorted>
        </picklist>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>Stage__c</fullName>
        <description>The Stage indicates if the survey (submission) belongs to Baseline or Ex-Post</description>
        <formula>IF(CONTAINS(Submission__r.Submission__r.gfsurveys__Survey__r.Name, &apos;PRD_02&apos;),&apos;LB&apos;,
IF(CONTAINS(Submission__r.Submission__r.gfsurveys__Survey__r.Name, &apos;PRD_03&apos;),&apos;XP&apos;,&apos;&apos;))</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Stage</label>
        <type>Text</type>
    </fields>
    <fields>
        <fullName>Submission__c</fullName>
        <label>Submission</label>
        <referenceTo>Mana_Food_Consumption_Submission__c</referenceTo>
        <relationshipLabel>Food Consumption Records</relationshipLabel>
        <relationshipName>Food_Consumption_Records</relationshipName>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>Total_Quantity_Consumed__c</fullName>
        <formula>IF(OR(ISBLANK(Quantity_Code__c),ISNULL(Quantity_Code__c)), Number_Consumed__c ,  Number_Consumed__c * Unit_Quantity__c )</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Total Quantity Consumed</label>
        <precision>18</precision>
        <scale>2</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>Unit_Quantity__c</fullName>
        <formula>IF(OR(ISBLANK(Quantity_Code__c),ISNULL(Quantity_Code__c)),0,Quantity_Code__r.Quantity__c)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Unit Quantity</label>
        <precision>18</precision>
        <scale>2</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>Units__c</fullName>
        <formula>TEXT(Food__r.Units__c)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Units</label>
        <type>Text</type>
    </fields>
    <fields>
        <fullName>XP_Total_quantity_consumed__c</fullName>
        <formula>IF( XP__c =1, Total_Quantity_Consumed__c ,0)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>XP_Total quantity consumed</label>
        <precision>18</precision>
        <scale>2</scale>
        <type>Number</type>
    </fields>
    <fields>
        <fullName>XP__c</fullName>
        <description>Este campo se llenará con un workflow rule, si es Ex-post se asignará el valor &apos;1&apos;, en caso contrario &apos;0&apos;</description>
        <label>XP</label>
        <precision>18</precision>
        <scale>0</scale>
        <type>Number</type>
    </fields>
    <label>Mana Food Consumption Record</label>
    <listViews>
        <fullName>All</fullName>
        <columns>NAME</columns>
        <columns>OBJECT_ID</columns>
        <columns>Food__c</columns>
        <columns>Household__c</columns>
        <columns>Number_Consumed__c</columns>
        <columns>Source__c</columns>
        <columns>Quantity_Code__c</columns>
        <columns>Collection_Date__c</columns>
        <columns>Submission__c</columns>
        <columns>CREATEDBY_USER.ALIAS</columns>
        <columns>CREATED_DATE</columns>
        <columns>UPDATEDBY_USER.ALIAS</columns>
        <columns>LAST_UPDATE</columns>
        <filterScope>Everything</filterScope>
        <label>All</label>
    </listViews>
    <nameField>
        <displayFormat>{0000000000}</displayFormat>
        <label>Id</label>
        <type>AutoNumber</type>
    </nameField>
    <pluralLabel>Mana Food Consumption Records</pluralLabel>
    <searchLayouts/>
    <sharingModel>ControlledByParent</sharingModel>
    <validationRules>
        <fullName>Food_Must_Match</fullName>
        <active>true</active>
        <description>This rule checks that the code belongs to the same food that&apos;s mapped to this column. Either Quantity_Code__c is blank or null, OR it must be equal to a code from the same food type.</description>
        <errorConditionFormula>AND(NOT(OR(ISBLANK(Quantity_Code__c),ISNULL(Quantity_Code__c))), (Food__c  &lt;&gt;  Quantity_Code__r.Food__c))</errorConditionFormula>
        <errorDisplayField>Quantity_Code__c</errorDisplayField>
        <errorMessage>The Quantity Code selected must belong to the same Food tied to this record.</errorMessage>
    </validationRules>
</CustomObject>
